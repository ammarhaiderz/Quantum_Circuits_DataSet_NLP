\begin{quantikz}
\lstick[3]{noisy EPR} &\qwbundle{n} & \gate[4]{CRO}\gategroup[4,steps=1,style={dashed,rounded corners,fill=blue!20, inner xsep=2pt},background,label style={label position=above,anchor=north,yshift=0.25cm}]{Hashing}  &\slice{discard some \\ EPRs}& & \gate[2]{CRO}\gategroup[2,steps=1,style={dashed,rounded
corners, inner xsep=2pt}]{IR}   & & \gate[2]{CRO}\gategroup[2,steps=1,style={dashed,rounded
corners, inner xsep=2pt}]{PA}  &\meter{} &\setwiretype{c} \\
  &\setwiretype{n} \vdots & &\setwiretype{n}& \wire[d][2]{q}  &  \setwiretype{q} &\setwiretype{n} \wire[d][2]{q}&\setwiretype{q} &\setwiretype{n} & \\
  &\qwbundle{n} & &\setwiretype{n}&&   & & & & \\
\lstick[1]{ancilla}  && &\setwiretype{n}& {\text{ancilla}} &  & {\text{ancilla}} &  &
\end{quantikz}