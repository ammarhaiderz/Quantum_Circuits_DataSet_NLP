\begin{quantikz}[row sep=0.3cm]
 \lstick{$\ket{\psi_A}$} & \gategroup[2,steps=7,style={dashed,rounded
corners,fill=blue!10, inner
xsep=0pt},background,label style={label
position=above,anchor=north,yshift=0.3cm}]{{\sc
control qubit core}} & \ctrl{1} & & & & \gate{Z} & & \\
    \makeebit[angle=-30]{$\ket{\phi^+}$} & & \targ{} && \meter{} & \ctrl[vertical wire=c]{2} \setwiretype{c} \\[4ex]
     & \gategroup[2,steps=7,style={dashed,rounded
corners,fill=red!10, inner
xsep=0pt},background,label style={label
position=below,anchor=north,yshift=-0.3cm}]{{\sc
target qubit core}} & \ctrl{1} & \gate{H} & \meter{} & \setwiretype{c} & \ctrl[vertical wire=c]{-2} \\
\lstick{$\ket{\psi_B}$} &  & \targ{} & & & \gate{X}& & &
\end{quantikz}