\begin{quantikz}[scale=0.3]
 & \lstick{$\ket{0}$} &&\gate[4]{U(f * x_{i})}\gategroup[4,steps=1,style={dashed,rounded
corners,fill=blue!20, inner
xsep=2pt},background,label style={label
position=above,anchor=north,yshift=+0.4cm}]{{\sc $S(\textbf{x})$}}&\gate{R_X(\theta_{0})}\gategroup[4,steps=5,style={dashed,rounded
corners, inner xsep=2pt},background,label style={label position=above,anchor=north,yshift=+0.4cm}]{{\sc $W(\boldsymbol{\theta})$}} & \ctrl{1} &\qw&\qw& \targ{1} & \meter{} 
& & 
\\ &\lstick{$\ket{0}$} &\qw&\qw& \gate{R_X(\theta_{1})} &  \targ{2} & \ctrl{1} &\qw&\qw& \meter{}
& &
\\ &\lstick{$\ket{0}$} &\qw&\qw& \gate{R_X(\theta_{2})} &\qw& \targ{2} & \ctrl{1} &\qw & \meter{}
& &
\\ &\lstick{$\ket{0}$} &\qw&\qw& \gate{R_X(\theta_{3})} &\qw&\qw& \targ{2} & \ctrl{-3} & \meter{}
\end{quantikz}