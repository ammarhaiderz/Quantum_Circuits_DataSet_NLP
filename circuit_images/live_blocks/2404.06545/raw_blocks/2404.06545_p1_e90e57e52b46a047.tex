\begin{quantikz}[column sep = 0.475cm]
        &\push{Z}& \ctrl{1}\gategroup[3,steps=1,style={dashed,rounded corners,fill=blue!30,inner sep=2pt},background]{2} && \gate{I}\gategroup[3,steps=1,style={dashed,rounded
        corners,fill=red!10,inner sep=2pt},background]{1} && \gate{H}\gategroup[3,steps=1,style={dashed,rounded
        corners,fill=green!20,inner sep=2pt},background]{3} && \ctrl{1}\gategroup[3,steps=1,style={dashed,rounded
        corners,fill=blue!30,inner sep=2pt},background]{2} &\push{Z}& \\
        &\push{X}& \control{} &\push{X}& \ctrl{1} &\push{X}& \gate{S} &\push{Y}& \control{} &\push{Y}& \\
        && \gate{H} && \control{} &\push{Z}& \gate{H} &\push{X}& \gate{H} &\push{Z}& 
    \end{quantikz}