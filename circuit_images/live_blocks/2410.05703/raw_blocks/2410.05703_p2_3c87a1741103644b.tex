\begin{quantikz}
    \lstick[wires = 1]{$\ket{0^{N-m}}$} &\targ{} &\ctrl[style=red]{1} \gategroup[3,steps=10,style={inner sep=6pt}]{$\times \ell$}&\swap{1}&\swap{1}&\ctrl{1}&\ctrl[style=red]{2}&\targ[style=red]{}&{}&\targ[style=red]{}&{}&\targ{}&\rstick[wires = 3]{$\hat{U}^\dagger \ket{0^{N-m}} \ket{\phi}$}\\
    \lstick[wires = 2]{$\ket{\phi}$}  &{}&\swap[style=red]{1}& \ctrl{1} &\targX{}&\targ{}&{}&\ctrl[style=red]{-1}&\ctrl{1}&{}&\targ{}&\targ[style=red]{}&{}\\
    {}  & {} &\targX[style=red]{}&\targX{}&\ctrl{-1}&{}&\targ[style=red]{}&{}&\targ{}&\ctrl[style=red]{-2}&\ctrl{-1}&\targ{}&{}
\end{quantikz}