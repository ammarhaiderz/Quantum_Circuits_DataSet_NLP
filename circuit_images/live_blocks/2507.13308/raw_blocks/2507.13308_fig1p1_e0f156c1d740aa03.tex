\begin{quantikz}[row sep=0.6cm, column sep=0.2cm]
   \lstick[4]{$\ell$} 
        &\wireoverride{n} 
        &\wireoverride{n}
         &\wireoverride{n}
          &\wireoverride{n}
    \lstick{$|0\rangle$}       & \gate{H}     & \ctrl{4}       & \qw             & \qw    & \qw     & \qw           & \gate[wires=4]{U_{\rm QFT}^{\dagger}} & \meter{k_0} & \qw \\
     &\wireoverride{n} 
        &\wireoverride{n}
         &\wireoverride{n}
          &\wireoverride{n}
    \lstick{$|0\rangle$}       & \gate{H}     & \qw            & \ctrl{3}          & \qw   & \qw     & \qw           &                                & \meter{k_1} & \qw \\
     &\wireoverride{n} 
        &\wireoverride{n}
         &\wireoverride{n}
          &\wireoverride{n}
    \lstick{$\vdots$}                                                                                          \\
     &\wireoverride{n} 
        &\wireoverride{n}
         &\wireoverride{n}
          &\wireoverride{n}
    \lstick{$|0\rangle$}   & \gate{H}     & \qw            & \qw             & \qw  & \qw      & \ctrl{1}      &                                & \meter{k_{l-1}} & \qw \\
     &\wireoverride{n} 
        &\wireoverride{n}
         &\wireoverride{n}
          &\wireoverride{n}
    \lstick{$|\psi(s,p)\rangle^{\otimes n}$}      & \qw          & \gate{U^{2^0}} & \gate{U^{2^1}}& \qw   & \ldots \ldots       & \gate{U^{2^{\ell-1}}} & \qw                             & \rstick{$|D^{(s)}_{n,k}\rangle$}
    \end{quantikz}