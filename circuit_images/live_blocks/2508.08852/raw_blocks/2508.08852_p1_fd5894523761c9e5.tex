\begin{quantikz}[column sep = 2.5mm]
    \lstick{$\ket{\varnothing}^{\otimes n}$} &[-3mm] \qw
    & \qw \slice[style=black, label style={yshift=1mm}]{$\psr{0}$}
    & \qw & \gate{\tra} \gategroup[3,steps=3,style={fill=gray!25,inner xsep=2pt},background,label style={label position=below,anchor=north,yshift=-0.2cm}]{{$\rec$}}
    & \gate[wires=3]{\ora^{\pm}} & \gate{\tra}
    & \qw \slice[style=black, label style={yshift=1mm}]{$\psr{1}$}
    & \qw &[-2mm] \qw & \ \ldots\ \qw & \qw
    & \gate{\tra} \gategroup[3,steps=3,style={fill=gray!25,inner xsep=2pt},background,label style={label position=below,anchor=north,yshift=-0.2cm}]{{$\rec$}}
    & \gate[wires=3]{\ora^{\pm}} & \gate{\tra}
    & \qw \slice[style=black, label style={yshift=1mm}]{$\psr{T}$}
    & \qw &[-2mm] \gate{\tra} & \qw \slice[style=black, label style={yshift=1mm}]{$\pst{T}$}
    &[-2mm] \qw &[-1mm] \qw \\
    \lstick{$\ket{0}$} & \qw & \gate[wires=2]{U_0} & \qw & \qw & \qw & \qw & \qw & \qw & \gate[wires=2]{U_1} & \ \ldots\ \qw & \qw & \qw & \qw & \qw & \qw & \qw & \gate[wires=2]{U_T} &  \qw & \qw & \meter{}  \\
    \lstick{$\ket{0}$} & \qw & \qw & \qw & \qw &  \qw & \qw & \qw & \qw & \qw & \ \ldots\ \qw & \qw & \qw & \qw & \qw & \qw & \qw & \qw & \qw & \qw & \qw
  \end{quantikz}